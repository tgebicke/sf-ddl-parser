create or replace view VW_CREDENTIALSCAN(
	CREDENTIALED_SCAN,
	ASSET_ID_TATTOO,
	AWS_INSTANCESTATUS,
	BIGFIX_ASSET_ID,
	BIOS_GUID,
	CLOUD_ID,
	COMPUTER_TYPE,
	DATACENTER_ACRONYM,
	DATACENTER_COMMONNAME,
	DATACENTER_ID,
	DATEMODIFIED,
	DEVICEMODEL,
	DEVICEROLE,
	DEVICETYPE,
	DW_ASSET_ID,
	ENVIRONMENT,
	FQDN,
	HOSTNAME,
	INSERT_DATE,
	IPV4,
	IPV6,
	IS_APPLICABLE,
	IS_SCANNABLE,
	IS_TATTOOABLE,
	LAST_CONFIRMED_TIME,
	LASTASSETUPDATE,
	LASTSEEN_CSM,
	LASTSEEN_HWAM,
	LASTSEEN_SWAM,
	LASTSEEN_VUL,
	MACADDRESS,
	MOTHERBOARD,
	NETBIOSNAME,
	OS,
	OS_CPE,
	OS_VERSION,
	SOURCE_TOOL_CREATE,
	SOURCE_TOOL_CSM,
	SOURCE_TOOL_HWAM,
	SOURCE_TOOL_LASTSEEN,
	SOURCE_TOOL_SWAM,
	SOURCE_TOOL_VUL,
	SYSTEM_ACRONYM,
	SYSTEM_COMMONNAME,
	SYSTEM_ID,
	TENABLEUUID,
	VULNRISKTOLERANCE
) as
with c as (
select distinct dnsname,IFF(UPPER(replace(credentialed_scan,'\n')) in ('TRUE','FALSE'),replace(credentialed_scan,'\n'),'Unknown') as credentialed_scan from app_tenable.shared.SEC_VW_CCIC_TENABLE_CUMULATIVE_INFO where reportdate >= CURRENT_DATE() and plugin_id=19506 
)
select c.credentialed_scan
,a.ASSET_ID_TATTOO
,a.AWS_INSTANCESTATUS
,a.BIGFIX_ASSET_ID
,a.BIOS_GUID
,a.CLOUD_ID
,a.COMPUTER_TYPE
,a.DATACENTER_ACRONYM
,a.DATACENTER_COMMONNAME
,a.DATACENTER_ID
,a.DATEMODIFIED
,a.DEVICEMODEL
,a.DEVICEROLE
,a.DEVICETYPE
,a.DW_ASSET_ID
,a.ENVIRONMENT
,a.FQDN
,a.HOSTNAME
,a.INSERT_DATE
,a.IPV4
,a.IPV6
,a.IS_APPLICABLE
,a.IS_SCANNABLE
,a.IS_TATTOOABLE
,a.LAST_CONFIRMED_TIME
,a.LASTASSETUPDATE
,a.LASTSEEN_CSM
,a.LASTSEEN_HWAM
,a.LASTSEEN_SWAM
,a.LASTSEEN_VUL
,a.MACADDRESS
,a.MOTHERBOARD
,a.NETBIOSNAME
,a.OS
,a.OS_CPE
,a.OS_VERSION
,a.SOURCE_TOOL_CREATE
,a.SOURCE_TOOL_CSM
,a.SOURCE_TOOL_HWAM
,a.SOURCE_TOOL_LASTSEEN
,a.SOURCE_TOOL_SWAM
,a.SOURCE_TOOL_VUL
,a.SYSTEM_ACRONYM
,a.SYSTEM_COMMONNAME
,a.SYSTEM_ID
,a.TENABLEUUID
,a.VULNRISKTOLERANCE
from core.vw_assets a join c on a.fqdn=c.dnsname or a.hostname=c.dnsname
UNION ALL
select true,
ASSET_ID_TATTOO
,AWS_INSTANCESTATUS
,BIGFIX_ASSET_ID
,BIOS_GUID
,CLOUD_ID
,COMPUTER_TYPE
,DATACENTER_ACRONYM
,DATACENTER_COMMONNAME
,DATACENTER_ID
,DATEMODIFIED
,DEVICEMODEL
,DEVICEROLE
,DEVICETYPE
,DW_ASSET_ID
,ENVIRONMENT
,FQDN
,HOSTNAME
,INSERT_DATE
,IPV4
,IPV6
,IS_APPLICABLE
,IS_SCANNABLE
,IS_TATTOOABLE
,LAST_CONFIRMED_TIME
,LASTASSETUPDATE
,LASTSEEN_CSM
,LASTSEEN_HWAM
,LASTSEEN_SWAM
,LASTSEEN_VUL
,MACADDRESS
,MOTHERBOARD
,NETBIOSNAME
,OS
,OS_CPE
,OS_VERSION
,SOURCE_TOOL_CREATE
,SOURCE_TOOL_CSM
,SOURCE_TOOL_HWAM
,SOURCE_TOOL_LASTSEEN
,SOURCE_TOOL_SWAM
,SOURCE_TOOL_VUL
,SYSTEM_ACRONYM
,SYSTEM_COMMONNAME
,SYSTEM_ID
,TENABLEUUID
,VULNRISKTOLERANCE
from core.vw_assets where aws_instancestatus is not null;