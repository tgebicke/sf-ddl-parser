create or replace view VW_CREDENTIALSCAN_OBSOLETE_241024(
	CREDENTIALED_SCAN,
	ASSET_ID_TATTOO,
	AWS_INSTANCESTATUS,
	BIGFIX_ASSET_ID,
	BIOS_GUID,
	CLOUD_ID,
	COMPUTER_TYPE,
	DATACENTER_ACRONYM,
	DATACENTER_COMMONNAME,
	DATACENTER_ID,
	DATEMODIFIED,
	DEVICEMODEL,
	DEVICEROLE,
	DEVICETYPE,
	DW_ASSET_ID,
	ENVIRONMENT,
	FQDN,
	HOSTNAME,
	INSERT_DATE,
	IPV4,
	IPV6,
	IS_APPLICABLE,
	IS_SCANNABLE,
	IS_TATTOOABLE,
	LAST_CONFIRMED_TIME,
	LASTASSETUPDATE,
	LASTSEEN_CSM,
	LASTSEEN_HWAM,
	LASTSEEN_SWAM,
	LASTSEEN_VUL,
	MACADDRESS,
	MOTHERBOARD,
	NETBIOSNAME,
	OS,
	OS_CPE,
	OS_VERSION,
	SOURCE_TOOL_CREATE,
	SOURCE_TOOL_CSM,
	SOURCE_TOOL_HWAM,
	SOURCE_TOOL_LASTSEEN,
	SOURCE_TOOL_SWAM,
	SOURCE_TOOL_VUL,
	SYSTEM_ACRONYM,
	SYSTEM_COMMONNAME,
	SYSTEM_ID,
	TENABLEUUID,
	VULNRISKTOLERANCE
) as
with c as (
select distinct dnsname,IFF(UPPER(replace(credentialed_scan,'\n')) in ('TRUE','FALSE'),replace(credentialed_scan,'\n'),'Unknown') as credentialed_scan from app_tenable.shared.SEC_VW_CCIC_TENABLE_CUMULATIVE_INFO where reportdate >= CURRENT_DATE() and plugin_id=19506 
)
select c.credentialed_scan,a.* from core.vw_assets a join c on a.fqdn=c.dnsname or a.hostname=c.dnsname
UNION ALL
select true,* from core.vw_assets where aws_instancestatus is  not null;