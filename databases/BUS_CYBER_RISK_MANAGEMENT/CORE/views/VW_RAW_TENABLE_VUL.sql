create or replace view VW_RAW_TENABLE_VUL(
	RAW_TENABLE_VUL_ID,
	DATACENTER_ACRONYM,
	SYSTEM_ACRONYM,
	ACCEPT_RISK_RULE_COMMENT,
	ACCEPTRISK,
	ACRSCORE,
	APPLICABILITYCODE,
	ASSET_ID_TATTOO,
	ASSETEXPOSURESCORE,
	AWS_ACCOUNTID,
	AZURE_SUBSCRIPTION_ID,
	BASESCORE,
	BID,
	CHECKTYPE,
	CPE,
	CREDENTIALED_SCAN,
	CUSTOM_SEVERITY,
	CVE,
	CVSSV2BASESCORE,
	CVSSV3BASESCORE,
	CVSSV3TEMPORALSCORE,
	CVSSV3VECTOR,
	CVSSVECTOR,
	DATA_ERROR_ARRAY,
	DATA_WARNING_ARRAY,
	DATACENTER_ID,
	DATECOMPLETED,
	DESCRIPTION,
	DNSNAME,
	DW_ASSET_ID,
	DW_DUP_NUMBER,
	DW_VUL_ID,
	EXPLOIT_AVAILABLE,
	EXPLOITEASE,
	EXPLOITFRAMEWORKS,
	FAMILY_ID,
	FAMILY_NAME,
	FAMILY_TYPE,
	FIRST_SEEN,
	FISMASEVERITY,
	HAS_BEEN_MITIGATED,
	HOSTNAME,
	HOSTUNIQUENESS,
	HOSTUUID,
	INSERT_DATE,
	IP,
	IPS,
	IS_PRIMARY_FISMA_ID_DEFAULTED_TO_DC,
	KEYDRIVERS,
	LAST_SEEN,
	MACADDRESS,
	MITIGATIONSTATUS,
	NETBIOSNAME,
	NUMERIC_SEVERITY,
	OPERATING_SYSTEM,
	PATCHPUB_DATE,
	PLUGIN_ID,
	PLUGIN_INFO,
	PLUGIN_MOD_DATE,
	PLUGIN_NAME,
	PLUGIN_PUB_DATE,
	PLUGINTEXT,
	PORT,
	PRIMARY_FISMA_ID_DERIVED,
	PRIMARY_FISMA_ID_TATTOO,
	PROTOCOL,
	RECASTRISK,
	RECASTRISKRULECOMMENT,
	REPORTDATE,
	REPOSITORY_DATAFORMAT,
	REPOSITORY_DESCRIPTION,
	REPOSITORY_ID,
	REPOSITORY_NAME,
	RISKFACTOR,
	ROWDISPOSITION,
	SCAN_POLICY_NAME,
	SCAN_POLICY_UID,
	SCAN_START_DATE,
	SEEALSO,
	SEVERITY_DESCRIPTION,
	SEVERITY_ID,
	SEVERITY_NAME,
	SNAPSHOT_DATACATEGORY,
	SNAPSHOT_DATE,
	SNAPSHOT_ID,
	SOLUTION,
	STATE,
	STIGSEVERITY,
	SYNOPSIS,
	SYSTEM_ID,
	TEMPORAL_SCORE,
	TENABLEUUID,
	UNIQUENESS,
	VERSION,
	VPR_SCORE,
	VPRCONTEXT,
	VULN_PUB_DATE,
	XREF
) COMMENT='shows all raw vulnerability from TENABLE  by snapshot date. '
 as
SELECT
v.RAW_TENABLE_VUL_ID
,dc.ACRONYM as DATACENTER_ACRONYM
,s.ACRONYM as SYSTEM_ACRONYM
,v.ACCEPT_RISK_RULE_COMMENT
,v.ACCEPTRISK
,v.ACRSCORE
,v.APPLICABILITYCODE
,v.ASSET_ID_TATTOO
,v.ASSETEXPOSURESCORE
,v.AWS_ACCOUNTID
,v.AZURE_SUBSCRIPTION_ID -- 241125 CR1038
,v.BASESCORE
,v.BID
,v.CHECKTYPE
,v.CPE
,v.CREDENTIALED_SCAN
,v.CUSTOM_SEVERITY
,v.CVE
,v.CVSSV2BASESCORE
,v.CVSSV3BASESCORE
,v.CVSSV3TEMPORALSCORE
,v.CVSSV3VECTOR
,v.CVSSVECTOR
,v.DATA_ERROR_ARRAY
,v.DATA_WARNING_ARRAY
,v.DATACENTER_ID
,v.DATECOMPLETED
,v.DESCRIPTION
,v.DNSNAME
,v.DW_ASSET_ID
,v.DW_DUP_NUMBER
-- 231027 ,v.DW_PLUGIN_ID
,v.DW_VUL_ID
,v.EXPLOIT_AVAILABLE
,v.EXPLOITEASE
,v.EXPLOITFRAMEWORKS
,v.FAMILY_ID
,v.FAMILY_NAME
,v.FAMILY_TYPE
,v.FIRST_SEEN
,v.FISMASEVERITY
,v.HAS_BEEN_MITIGATED
,v.HOSTNAME
,v.HOSTUNIQUENESS
,v.HOSTUUID
,v.INSERT_DATE
,v.IP
,v.IPS
,v.IS_PRIMARY_FISMA_ID_DEFAULTED_TO_DC
,v.KEYDRIVERS
,v.LAST_SEEN
,v.MACADDRESS
,v.MITIGATIONSTATUS
,v.NETBIOSNAME
,v.NUMERIC_SEVERITY
,v.OPERATING_SYSTEM
,v.PATCHPUB_DATE
,v.PLUGIN_ID
,v.PLUGIN_INFO
,v.PLUGIN_MOD_DATE
,v.PLUGIN_NAME
,v.PLUGIN_PUB_DATE
,v.PLUGINTEXT
,v.PORT
,v.PRIMARY_FISMA_ID_DERIVED
,v.PRIMARY_FISMA_ID_TATTOO
,v.PROTOCOL
,v.RECASTRISK
,v.RECASTRISKRULECOMMENT
,v.REPORTDATE
,v.REPOSITORY_DATAFORMAT
,v.REPOSITORY_DESCRIPTION
,v.REPOSITORY_ID
,v.REPOSITORY_NAME
,v.RISKFACTOR
,v.ROWDISPOSITION
,v.SCAN_POLICY_NAME
,v.SCAN_POLICY_UID
,v.SCAN_START_DATE
,v.SEEALSO
,v.SEVERITY_DESCRIPTION
,v.SEVERITY_ID
,v.SEVERITY_NAME
,snap.DATACATEGORY as SNAPSHOT_DATACATEGORY
,snap.SNAPSHOT_DATE
,v.SNAPSHOT_ID
,v.SOLUTION
,v.STATE
,v.STIGSEVERITY
,v.SYNOPSIS
,v.SYSTEM_ID
,v.TEMPORAL_SCORE
,v.TENABLEUUID
,v.UNIQUENESS
-- 231027,v.VAL_ASSET_ID_TATTOO
,v.VERSION
,v.VPR_SCORE
,v.VPRCONTEXT
,v.VULN_PUB_DATE
,v.XREF
FROM CORE.RAW_TENABLE_VUL v
LEFT OUTER JOIN CORE.SNAPSHOT_IDS snap on snap.SNAPSHOT_ID = v.SNAPSHOT_ID
LEFT OUTER JOIN CORE.SYSTEMS dc on dc.SYSTEM_ID = v.DATACENTER_ID
LEFT OUTER JOIN CORE.SYSTEMS s on s.SYSTEM_ID = v.SYSTEM_ID
;