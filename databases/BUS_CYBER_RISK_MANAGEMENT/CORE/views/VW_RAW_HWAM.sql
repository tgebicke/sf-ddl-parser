create or replace view VW_RAW_HWAM(
	RAW_HWAM_ID,
	VAL_DATACENTER_ACRONYM,
	VAL_SYSTEM_ACRONYM,
	COMMONNAME,
	ASSET_ID_TATTOO,
	AWS_ACCOUNTID,
	AWS_DATACENTER_ID,
	AWS_PRIMARY_FISMA_ID_TATTOO,
	AWS_INSTANCE_ID,
	AXONIUS_ADAPTER_LIST_LENGTH,
	AXONIUS_ADAPTERS,
	AXONIUS_ADAPTERS_UUID,
	AXONIUS_INTERNAL_AXONIUS_ID,
	BIGFIX_ASSET_ID,
	BIGFIX_ASSET_ID_TATTOO,
	BIGFIX_DATACENTER_ID,
	BIGFIX_PRIMARY_FISMA_ID_TATTOO,
	BIOS_GUID,
	CLOUD_ID,
	CLOUD_PROVIDER,
	COMPUTER_TYPE,
	CONNECTION_LABEL,
	DATA_ERROR_ARRAY,
	DATA_WARNING_ARRAY,
	DATACENTER_ID,
	DATECOMPLETED,
	DEVICE_MANUFACTURER,
	DEVICE_TYPE,
	DOMAIN_PREFERRED,
	ENVIRONMENT,
	EVENTTIME,
	FIRST_FETCH_TIME,
	FORESCOUT_ASSET_ID_TATTOO,
	FORESCOUT_DATACENTER_ID,
	FORESCOUT_PRIMARY_FISMA_ID,
	FQDN,
	HOSTNAME,
	INSERT_DATE,
	INSTANCESTATUS,
	IPV4,
	IPV6,
	IS_FS_MANAGED,
	IS_PRIMARY_FISMA_ID_DEFAULTED_TO_DC,
	IS_WINDOWS_SERVER_PREFERRED,
	LABELS,
	LAST_CONFIRMED_TIME,
	LAST_USED_USERS_COMPANY_ASSOCIATION,
	LAST_USED_USERS_DEPARTMENTS_ASSOCIATION,
	MACADDRESS,
	MOTHERBOARD,
	NETBIOSNAME,
	OS,
	OS_BUILD_PREFERRED,
	OS_CPE,
	OS_DOTTED,
	OS_MAJOR,
	OS_MINOR,
	OS_TYPE_DISTRIBUTION_PREFERRED,
	OS_TYPE_PREFERRED,
	OS_VERSION,
	PRIMARY_FISMA_ID_DERIVED,
	PRIMARY_FISMA_ID_TATTOO,
	REPORTDATE,
	ROWDISPOSITION,
	SITECODE_PREFERRED,
	SNAPSHOT_DATE,
	SNAPSHOT_ID,
	SOURCE_TOOL,
	SUBNETS_PREFERRED,
	SYSTEM_ACRONYM,
	SYSTEM_ID,
	TENABLE_ASSET_ID_TATTOO,
	TENABLE_ASSET_TAGS,
	TENABLE_DATACENTER_ID,
	TENABLE_PRIMARY_FISMA_ID_TATTOO,
	TIME_ZONE,
	VIRTUAL_HOST,
	WINDOWS_PATCH_VERSION
) COMMENT='Shows all raw HWAM (AWS,Axonious) feed by snapshot date. '
 as
SELECT
rh.RAW_HWAM_ID
,dc.acronym as VAL_DATACENTER_ACRONYM
,s.acronym as VAL_SYSTEM_ACRONYM
,s.COMMONNAME
,rh.ASSET_ID_TATTOO
,rh.AWS_ACCOUNTID
,rh.AWS_DATACENTER_ID
,rh.AWS_PRIMARY_FISMA_ID_TATTOO
,rh.AWS_INSTANCE_ID
,rh.AXONIUS_ADAPTER_LIST_LENGTH
,rh.AXONIUS_ADAPTERS
,rh.AXONIUS_ADAPTERS_UUID
,rh.AXONIUS_INTERNAL_AXONIUS_ID
,rh.BIGFIX_ASSET_ID
,rh.BIGFIX_ASSET_ID_TATTOO
,rh.BIGFIX_DATACENTER_ID
,rh.BIGFIX_PRIMARY_FISMA_ID_TATTOO
--,rh.BIGFIX_PRIMARY_FISMA_ID_TATTOO_DETAILS
,rh.BIOS_GUID
,rh.CLOUD_ID
,rh.CLOUD_PROVIDER
,rh.COMPUTER_TYPE
,rh.CONNECTION_LABEL
,rh.DATA_ERROR_ARRAY
,rh.DATA_WARNING_ARRAY
,rh.DATACENTER_ID
,rh.DATECOMPLETED
,rh.DEVICE_MANUFACTURER
,rh.DEVICE_TYPE
,rh.DOMAIN_PREFERRED
,rh.ENVIRONMENT
,rh.EVENTTIME
,rh.FIRST_FETCH_TIME
,rh.FORESCOUT_ASSET_ID_TATTOO
--,rh.FORESCOUT_ASSIGNED_LABELS
,rh.FORESCOUT_DATACENTER_ID
,rh.FORESCOUT_PRIMARY_FISMA_ID
,rh.FQDN
,rh.HOSTNAME
,rh.INSERT_DATE
,rh.INSTANCESTATUS
,rh.IPV4
,rh.IPV6
,rh.IS_FS_MANAGED
,rh.IS_PRIMARY_FISMA_ID_DEFAULTED_TO_DC
,rh.IS_WINDOWS_SERVER_PREFERRED
,rh.LABELS
,rh.LAST_CONFIRMED_TIME
,rh.LAST_USED_USERS_COMPANY_ASSOCIATION
,rh.LAST_USED_USERS_DEPARTMENTS_ASSOCIATION
,rh.MACADDRESS
,rh.MOTHERBOARD
,rh.NETBIOSNAME
,rh.OS
,rh.OS_BUILD_PREFERRED
,rh.OS_CPE
,rh.OS_DOTTED
,rh.OS_MAJOR
,rh.OS_MINOR
,rh.OS_TYPE_DISTRIBUTION_PREFERRED
,rh.OS_TYPE_PREFERRED
,rh.OS_VERSION
,rh.PRIMARY_FISMA_ID_DERIVED
,rh.PRIMARY_FISMA_ID_TATTOO
,rh.REPORTDATE
,rh.ROWDISPOSITION
,rh.SITECODE_PREFERRED
,snap.SNAPSHOT_DATE
,rh.SNAPSHOT_ID
,rh.SOURCE_TOOL
,rh.SUBNETS_PREFERRED
,rh.SYSTEM_ACRONYM
,rh.SYSTEM_ID
,rh.TENABLE_ASSET_ID_TATTOO
,rh.TENABLE_ASSET_TAGS
,rh.TENABLE_DATACENTER_ID
,rh.TENABLE_PRIMARY_FISMA_ID_TATTOO
,rh.TIME_ZONE
,rh.VIRTUAL_HOST
,rh.WINDOWS_PATCH_VERSION
FROM CORE.RAW_HWAM rh
LEFT OUTER JOIN CORE.VW_SYSTEMS dc on dc.SYSTEM_ID = rh.DATACENTER_ID
LEFT OUTER JOIN CORE.VW_SYSTEMS s on s.SYSTEM_ID = rh.SYSTEM_ID
LEFT OUTER JOIN CORE.SNAPSHOT_IDS snap on snap.SNAPSHOT_ID = rh.SNAPSHOT_ID
;