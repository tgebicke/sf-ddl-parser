create or replace view VW_QUERY_HISTORY(
	QUERY_TYPE,
	ERROR_MESSAGE,
	QUERY_TEXT,
	USER_NAME,
	START_TIME,
	END_TIME,
	TOTAL_ELAPSED_TIME,
	COMPILATION_TIME,
	EXECUTION_TIME,
	ROWS_PRODUCED,
	DATABASE_NAME,
	SCHEMA_NAME,
	SESSION_ID,
	ROLE_NAME,
	WAREHOUSE_NAME,
	WAREHOUSE_SIZE,
	WAREHOUSE_TYPE,
	CLUSTER_NUMBER,
	QUERY_TAG,
	EXECUTION_STATUS,
	ERROR_CODE,
	BYTES_SCANNED,
	QUERY_ID,
	QUEUED_PROVISIONING_TIME,
	QUEUED_REPAIR_TIME,
	QUEUED_OVERLOAD_TIME,
	TRANSACTION_BLOCKED_TIME,
	OUTBOUND_DATA_TRANSFER_CLOUD,
	OUTBOUND_DATA_TRANSFER_REGION,
	OUTBOUND_DATA_TRANSFER_BYTES,
	INBOUND_DATA_TRANSFER_CLOUD,
	INBOUND_DATA_TRANSFER_REGION,
	INBOUND_DATA_TRANSFER_BYTES,
	CREDITS_USED_CLOUD_SERVICES,
	LIST_EXTERNAL_FILE_TIME,
	RELEASE_VERSION,
	EXTERNAL_FUNCTION_TOTAL_INVOCATIONS,
	EXTERNAL_FUNCTION_TOTAL_SENT_ROWS,
	EXTERNAL_FUNCTION_TOTAL_RECEIVED_ROWS,
	EXTERNAL_FUNCTION_TOTAL_SENT_BYTES,
	EXTERNAL_FUNCTION_TOTAL_RECEIVED_BYTES,
	IS_CLIENT_GENERATED_STATEMENT
) COMMENT='Diagnostic View to list queries executed against the CORE schema\t'
 as
select 
   QUERY_TYPE,
    ERROR_MESSAGE,
	QUERY_TEXT,
	USER_NAME,
    START_TIME,
	END_TIME,
	TOTAL_ELAPSED_TIME,
	COMPILATION_TIME,
	EXECUTION_TIME,
    ROWS_PRODUCED,
	DATABASE_NAME,
	SCHEMA_NAME,
	SESSION_ID,
	ROLE_NAME,
	WAREHOUSE_NAME,
	WAREHOUSE_SIZE,
	WAREHOUSE_TYPE,
	CLUSTER_NUMBER,
	QUERY_TAG,
	EXECUTION_STATUS,
	ERROR_CODE,
	BYTES_SCANNED,
    QUERY_ID,
	QUEUED_PROVISIONING_TIME,
	QUEUED_REPAIR_TIME,
	QUEUED_OVERLOAD_TIME,
	TRANSACTION_BLOCKED_TIME,
	OUTBOUND_DATA_TRANSFER_CLOUD,
	OUTBOUND_DATA_TRANSFER_REGION,
	OUTBOUND_DATA_TRANSFER_BYTES,
	INBOUND_DATA_TRANSFER_CLOUD,
	INBOUND_DATA_TRANSFER_REGION,
	INBOUND_DATA_TRANSFER_BYTES,
	CREDITS_USED_CLOUD_SERVICES,
	LIST_EXTERNAL_FILE_TIME,
	RELEASE_VERSION,
	EXTERNAL_FUNCTION_TOTAL_INVOCATIONS,
	EXTERNAL_FUNCTION_TOTAL_SENT_ROWS,
	EXTERNAL_FUNCTION_TOTAL_RECEIVED_ROWS,
	EXTERNAL_FUNCTION_TOTAL_SENT_BYTES,
	EXTERNAL_FUNCTION_TOTAL_RECEIVED_BYTES,
	IS_CLIENT_GENERATED_STATEMENT
from table(information_schema.query_history())
WHERE DATABASE_NAME='BUS_CYBER_RISK_MANAGEMENT' AND SCHEMA_NAME='CORE'
;