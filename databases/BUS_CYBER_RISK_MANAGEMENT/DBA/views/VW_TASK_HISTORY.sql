create or replace view VW_TASK_HISTORY(
	NAME,
	DATABASE_NAME,
	SCHEMA_NAME,
	QUERY_TEXT,
	STATE,
	QUERY_START_TIME,
	COMPLETED_TIME,
	ELAPSED_MILLISECONDS,
	NEXT_SCHEDULED_TIME,
	ERROR_CODE,
	ERROR_MESSAGE,
	CONDITION_TEXT,
	SCHEDULED_TIME,
	QUERY_ID,
	ROOT_TASK_ID,
	GRAPH_VERSION,
	RUN_ID,
	RETURN_VALUE,
	SCHEDULED_FROM
) COMMENT='Diagnostic View to list execution of background/scheduled tasks (7 days only)\t'
 as
select 
	NAME,
	DATABASE_NAME,
	SCHEMA_NAME,
	QUERY_TEXT,
	STATE,
    QUERY_START_TIME,
    COMPLETED_TIME,
    datediff(millisecond,QUERY_START_TIME,COMPLETED_TIME),
    NEXT_SCHEDULED_TIME,
	ERROR_CODE,
	ERROR_MESSAGE,
    CONDITION_TEXT,
	SCHEDULED_TIME,
	QUERY_ID,
	ROOT_TASK_ID,
	GRAPH_VERSION,
	RUN_ID,
	RETURN_VALUE,
	SCHEDULED_FROM
from table(information_schema.task_history());