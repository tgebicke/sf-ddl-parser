create or replace view VW_SYSTEMSHIST(
	ACRONYM,
	ACTUAL_DECOMMISION_DATE,
	ARCHER_TRACKING_ID,
	ATO_EXPIRATION_DATE,
	ATO_REVIEW_DATE,
	AUTH_COMMENTS,
	AUTH_DECISION,
	AUTHORIZATION_MEMO_SIGNED_DATE,
	AUTHORIZATION_PACKAGE,
	BO_RECOMMENDATION_REVIEW_DATE,
	BO_REVIEW_DATE,
	BUSINESS_OWNER,
	CIO,
	CISO,
	CISO_REVIEW_DATE,
	CLOUD_SERVICE_PROVIDER,
	COMPONENT_ACRONYM,
	COMPONENT_DESCRIPTION,
	COMPONENT_NAME,
	COMPONENT_RISK_REPORTS_OVERSIGHT,
	CONTINGENCYEXPIRATIONDATE,
	CONTROL_SET_VERSION_NUMBER_SYSTEM_PROVID,
	CP_TEST_DATE,
	CP_TEST_RESULTS,
	CRA,
	CRA_REVIEW_DATE,
	CYBERVET,
	DATE_AUTH_MEMO_EXPIRES,
	DATE_AUTH_MEMO_SIGNED,
	DATEDELETED,
	DATEMODIFIED,
	DCISO,
	DIRECTOR_COMMENT,
	DIRECTOR_COMMENT2,
	DIVISION_ACRONYM,
	DIVISION_DESCRIPTION,
	DIVISION_NAME,
	DSPC_REVIEW_DATE,
	DSPPO_REVIEW_DATE,
	E_AUTH_EXP_DATE,
	E_AUTH_LEVEL,
	E_AUTH_RISK_ASSESSMENT_DATE,
	FINANCIAL_SYSTEM,
	FIPS_199_AVAILABILITY_RATING,
	FIPS_199_CONFIDENTIALITY_RATING,
	FIPS_199_INTEGRITY_RATING,
	FIPS_199_OVERALL_IMPACT_RATING,
	FIRST_PUBLISHED_DATE,
	FISMA_SYSTEM,
	GROUP_ACRONYM,
	GROUP_DESCRIPTION,
	GROUP_NAME,
	HVA_SCORE,
	HVASTATUS,
	IN_CMS_CLOUD,
	INFORMATION_SYSTEM_TYPE,
	IS_CCSQ,
	IS_DATACENTER,
	IS_EXCLUDEFROMREPORTING,
	IS_HIGHRISKSYSTEM,
	IS_MARKETPLACE,
	IS_OA_READY,
	IS_OPERATIONALSYSTEM,
	IS_PHANTOMSYSTEM,
	IS_SECURITYHUB_ENABLED,
	ISRA_REVIEW_DATE,
	ISRA_STATUS,
	ISSO,
	ISSO_COUNT,
	ISSO_REVIEW_DATE,
	ISSO_SUBMISSION_DATE,
	ISSOCS,
	LAST_ACT_DATE,
	LAST_ACT_SCA_CAAT_PROCESSED_FILE_DATE,
	LAST_ACT_SCA_FINAL_REPORT_DATE,
	LAST_PENTEST_CAAT_PROCESSED_FILE_DATE,
	LAST_PENTEST_DATE,
	MEF,
	MEF_CONTEXT,
	MEFSTATUS,
	NEXT_REQUIRED_CP_TEST_DATE,
	OA_STATUS,
	OATO_CATEGORY,
	OPERATED_BY,
	PACKAGE_TYPE,
	PIA_014,
	PIA_EXPIRATION_DATE,
	PII_PHI,
	PRIMARY_ISSO,
	PRIMARY_OPERATING_LOCATION,
	PRIMARY_OPERATING_LOCATION_ID,
	REASON_FOR_ATO_REQUEST,
	REPORT_DATE,
	REPORT_ID,
	SCA,
	SCA_DATE,
	SDM,
	SOP_REVIEW_DATE,
	STE_DATE,
	SYSTEM_CREATION_DATE,
	SYSTEM_DESCRIPTION,
	SYSTEM_ID,
	TLC_PHASE,
	TOTALPOAMWITHAPPROVEDRBD
) COMMENT='Return all systems for all report_id to show history of system changes if any.'
 as
SELECT 
--
-- 250103 CR1060 Re-baseline view with SYSTEMSHIST table
-- Also note, prior to 250103 this was only reporting the current date and not history
--
sh.ACRONYM
,sh.ACTUAL_DECOMMISION_DATE
,sh.ARCHER_TRACKING_ID
,sh.ATO_EXPIRATION_DATE
,sh.ATO_REVIEW_DATE
,sh.AUTH_COMMENTS
,sh.AUTH_DECISION
,sh.AUTHORIZATION_MEMO_SIGNED_DATE
,sh.AUTHORIZATION_PACKAGE
,sh.BO_RECOMMENDATION_REVIEW_DATE
,sh.BO_REVIEW_DATE
,sh.BUSINESS_OWNER
,sh.CIO
,sh.CISO
,sh.CISO_REVIEW_DATE
,sh.CLOUD_SERVICE_PROVIDER
,sh.COMPONENT_ACRONYM
,sh.COMPONENT_DESCRIPTION
,sh.COMPONENT_NAME
,sh.COMPONENT_RISK_REPORTS_OVERSIGHT
,sh.CONTINGENCYEXPIRATIONDATE
,sh.CONTROL_SET_VERSION_NUMBER_SYSTEM_PROVID
,sh.CP_TEST_DATE
,sh.CP_TEST_RESULTS
,sh.CRA
,sh.CRA_REVIEW_DATE
,sh.CYBERVET
,sh.DATE_AUTH_MEMO_EXPIRES
,sh.DATE_AUTH_MEMO_SIGNED
,sh.DATEDELETED
,sh.DATEMODIFIED
,sh.DCISO
,sh.DIRECTOR_COMMENT
,sh.DIRECTOR_COMMENT2
,sh.DIVISION_ACRONYM
,sh.DIVISION_DESCRIPTION
,sh.DIVISION_NAME
,sh.DSPC_REVIEW_DATE
,sh.DSPPO_REVIEW_DATE
,sh.E_AUTH_EXP_DATE
,sh.E_AUTH_LEVEL
,sh.E_AUTH_RISK_ASSESSMENT_DATE
,sh.FINANCIAL_SYSTEM
,sh.FIPS_199_AVAILABILITY_RATING
,sh.FIPS_199_CONFIDENTIALITY_RATING
,sh.FIPS_199_INTEGRITY_RATING
,sh.FIPS_199_OVERALL_IMPACT_RATING
,sh.FIRST_PUBLISHED_DATE
,sh.FISMA_SYSTEM
,sh.GROUP_ACRONYM
,sh.GROUP_DESCRIPTION
,sh.GROUP_NAME
,sh.HVA_SCORE
,sh.HVASTATUS
,sh.IN_CMS_CLOUD
,sh.INFORMATION_SYSTEM_TYPE
,sh.IS_CCSQ
,sh.IS_DATACENTER
,sh.IS_EXCLUDEFROMREPORTING
,sh.IS_HIGHRISKSYSTEM
,sh.IS_MARKETPLACE
,sh.IS_OA_READY
,sh.IS_OPERATIONALSYSTEM
,sh.IS_PHANTOMSYSTEM
,sh.IS_SECURITYHUB_ENABLED
,sh.ISRA_REVIEW_DATE
,sh.ISRA_STATUS
,sh.ISSO
,sh.ISSO_COUNT
,sh.ISSO_REVIEW_DATE
,sh.ISSO_SUBMISSION_DATE
,sh.ISSOCS
,sh.LAST_ACT_DATE
,sh.LAST_ACT_SCA_CAAT_PROCESSED_FILE_DATE
,sh.LAST_ACT_SCA_FINAL_REPORT_DATE
,sh.LAST_PENTEST_CAAT_PROCESSED_FILE_DATE
,sh.LAST_PENTEST_DATE
,sh.MEF
,sh.MEF_CONTEXT
,sh.MEFSTATUS
,sh.NEXT_REQUIRED_CP_TEST_DATE
,sh.OA_STATUS
,sh.OATO_CATEGORY
,sh.OPERATED_BY
,sh.PACKAGE_TYPE
,sh.PIA_014
,sh.PIA_EXPIRATION_DATE
,sh.PII_PHI
,sh.PRIMARY_ISSO
,sh.PRIMARY_OPERATING_LOCATION
,sh.PRIMARY_OPERATING_LOCATION_ID
,sh.REASON_FOR_ATO_REQUEST
,r.REPORT_DATE
,sh.REPORT_ID
,sh.SCA
,sh.SCA_DATE
,sh.SDM
,sh.SOP_REVIEW_DATE
,sh.STE_DATE
,sh.SYSTEM_CREATION_DATE
,sh.SYSTEM_DESCRIPTION
,sh.SYSTEM_ID
,sh.TLC_PHASE
,sh.TOTALPOAMWITHAPPROVEDRBD
FROM CORE.REPORT_IDS r
JOIN CORE.SYSTEMSHIST sh on sh.REPORT_ID = r.REPORT_ID
WHERE r.IS_VIABLE = 1
;